<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover" />
<title>湊齊10000元</title>
<style>
  :root {
    --bg: #f9fafb;
    --panel: #ffffff;
    --border: #d1d5db;
    --text: #1e293b;
    --muted: #6b7280;
    --primary: #0071e3; /* Apple 藍 */
    --primary-light: #e8f0fe;
    --ok: #16a34a;
    --warn: #f59e0b;
    --err: #dc2626;
    --radius: 12px;
  }

  * { box-sizing: border-box; }
  body {
    margin: 0;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "SF Pro Display", "Helvetica Neue", Helvetica, Arial, sans-serif;
    background: var(--bg);
    color: var(--text);
    line-height: 1.6;
  }

  header {
    padding: 28px 20px 12px;
    text-align: center;
  }
  h1 {
    font-size: 24px;
    font-weight: 700;
    margin: 0;
    color: var(--text);
    letter-spacing: -0.3px;
  }
  .sub {
    font-size: 14px;
    color: var(--muted);
    margin-top: 4px;
  }

  .card {
    background: var(--panel);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 20px;
    margin: 20px auto;
    width: min(92%, 480px);
    box-shadow: 0 2px 8px rgba(0,0,0,.04);
  }

  .field {
    display:flex; flex-direction: column; gap: 6px; margin-bottom: 16px;
  }
  label { font-weight: 600; font-size: 15px; }
  input[type="number"] {
    width: 100%;
    padding: 12px 14px;
    border: 1px solid var(--border);
    border-radius: var(--radius);
    font-size: 16px;
    background: #fff;
    color: var(--text);
    outline: none;
    transition: border .2s ease, box-shadow .2s ease;
  }
  input[type="number"]::placeholder {
    color: #9ca3af;
  }
  input[type="number"]:focus {
    border-color: var(--primary);
    box-shadow: 0 0 0 4px rgba(0,113,227,.15);
  }
  input[type="number"]::-webkit-outer-spin-button,
  input[type="number"]::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }
  input[type="number"] { -moz-appearance: textfield; }

  .btns {
    display:flex; flex-direction: column; gap: 12px; margin-top: 8px;
  }
  button {
    width: 100%;
    padding: 14px 16px;
    border: none;
    border-radius: var(--radius);
    font-size: 17px;
    font-weight: 600;
    letter-spacing: .3px;
    cursor: pointer;
    transition: all .2s ease;
  }
  button.primary {
    background: var(--primary);
    color: #fff;
  }
  button.primary:hover {
    background: #0062c8;
  }
  button.secondary {
    background: #f3f4f6;
    color: var(--text);
  }
  button.secondary:hover {
    background: #e5e7eb;
  }

  .legend {
    margin-top: 10px;
    font-size: 13px;
    color: var(--muted);
    text-align: center;
  }

  .result {
    margin-top: 24px;
    display:flex;
    flex-direction: column;
    gap: 16px;
  }
  .status {
    text-align: center;
    font-weight: 700;
    font-size: 17px;
  }
  .status.ok { color: var(--ok); }
  .status.warn { color: var(--warn); }
  .status.err { color: var(--err); }

  /* 結果呈現 */
  .result-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    gap: 12px;
  }
  .coin {
    background: #f9fafb;
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 12px;
    text-align: center;
  }
  .coin .denom { font-size: 14px; color: var(--muted); }
  .coin .count {
    margin-top: 4px;
    font-size: 30px;
    font-weight: 800;
    color: var(--primary);
  }

  .summary {
    background: #f9fafb;
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 12px 16px;
  }
  .row {
    display:flex; justify-content: space-between;
    font-size: 15px;
    padding: 4px 0;
  }
  .row .label { color: var(--muted); }
  .row .value { font-weight: 700; }

  @media (min-width: 640px) {
    .btns { flex-direction: row; }
    .btns button { flex: 1; }
  }
</style>
</head>
<body>
  <header>
    <h1>湊齊10000元</h1>
    <div class="sub">小面額優先，500 元至少 6 枚；若無法剛好，將回傳最接近的結果。</div>
  </header>

  <section class="card">
    <div class="field">
      <label for="c500">500 元可用數量（至少 6）</label>
      <input id="c500" type="number" min="0" step="1" placeholder="請輸入數量">
    </div>
    <div class="field">
      <label for="c100">100 元可用數量</label>
      <input id="c100" type="number" min="0" step="1" placeholder="請輸入數量">
    </div>
    <div class="field">
      <label for="c50">50 元可用數量</label>
      <input id="c50" type="number" min="0" step="1" placeholder="請輸入數量">
    </div>
    <div class="field">
      <label for="c10">10 元可用數量</label>
      <input id="c10" type="number" min="0" step="1" placeholder="請輸入數量">
    </div>
    <div class="field">
      <label for="c1">1 元可用數量</label>
      <input id="c1" type="number" min="0" step="1" placeholder="請輸入數量">
    </div>

    <div class="btns">
      <button id="calcBtn" class="primary">計算</button>
      <button id="resetBtn" class="secondary">清空</button>
    </div>

    <div class="legend">按下「計算」後會自動捲動至結果區。</div>

    <div id="result" class="result"></div>
    <div id="result-end" style="height:1px;"></div>
  </section>

<script>
const TARGET = 10000;

function getInputs() {
  const num = id => {
    const v = document.getElementById(id).value.trim();
    if (v === "") return 0;
    const n = parseInt(v, 10);
    return isNaN(n) ? 0 : Math.max(0, n);
  };
  return {500:num('c500'), 100:num('c100'), 50:num('c50'), 10:num('c10'), 1:num('c1')};
}

function totalValue(avail) {
  return 500*avail[500] + 100*avail[100] + 50*avail[50] + 10*avail[10] + 1*avail[1];
}

// 嘗試在指定 target 內找到「小面額優先」且含至少 6 枚 500 的組合
function solveExactForTarget(target, avail) {
  if (avail[500] < 6) return null;

  const max1 = Math.min(avail[1], target);
  for (let use1 = max1 - (max1 % 10); use1 >= 0; use1 -= 10) {
    let remAfter1 = target - use1;

    let max10 = Math.min(avail[10], Math.floor(remAfter1 / 10));
    const needMod5 = (remAfter1 / 10) % 5;
    max10 = max10 - ((max10 - needMod5 + 5) % 5);

    for (let use10 = max10; use10 >= 0; use10 -= 5) {
      let remAfter10 = remAfter1 - 10 * use10;
      let max50 = Math.min(avail[50], Math.floor(remAfter10 / 50));
      const parity = (remAfter10 / 50) % 2;
      if ((max50 % 2) !== parity) max50--;

      for (let use50 = max50; use50 >= 0; use50 -= 2) {
        let remAfter50 = remAfter10 - 50 * use50;
        let use100 = Math.min(avail[100], Math.floor(remAfter50 / 100));
        let remAfter100 = remAfter50 - 100 * use100;

        if (remAfter100 % 500 !== 0) continue;
        let use500 = remAfter100 / 500;
        if (use500 > avail[500]) continue;

        // 若 500 < 6，嘗試換成 500
        if (use500 < 6) {
          let need = 6 - use500;
          let t100 = use100, t50 = use50, t10 = use10, t1 = use1, t500 = use500;
          while (need > 0 && t500 < avail[500]) {
            if (t100 >= 5) { t100 -= 5; t500++; need--; continue; }
            if (t50  >= 10){ t50  -= 10; t500++; need--; continue; }
            if (t10  >= 50){ t10  -= 50; t500++; need--; continue; }
            if (t1   >= 500){ t1   -= 500; t500++; need--; continue; }
            break;
          }
          if (need > 0) continue;
          use100 = t100; use50 = t50; use10 = t10; use1 = t1; use500 = t500;
        }

        if (use1 > avail[1] || use10 > avail[10] || use50 > avail[50] || use100 > avail[100] || use500 > avail[500]) continue;

        return {500:use500, 100:use100, 50:use50, 10:use10, 1:use1, sum: target};
      }
    }
  }
  return null;
}

// 找最接近 target 的可行解
function solveClosest(target, avail) {
  let exact = solveExactForTarget(target, avail);
  if (exact) return exact;
  const maxUp = totalValue(avail);
  const maxRadius = Math.max(target, maxUp - target);

  for (let d = 1; d <= maxRadius; d++) {
    const lower = target - d;
    const upper = target + d;
    if (lower >= 0) {
      const resL = solveExactForTarget(lower, avail);
      if (resL) return resL;
    }
    if (upper <= maxUp) {
      const resU = solveExactForTarget(upper, avail);
      if (resU) return resU;
    }
  }
  return null;
}

function coinBox(label, count) {
  return `
    <div class="coin">
      <div class="denom">${label}</div>
      <div class="count">${count}</div>
    </div>
  `;
}

function renderResult(sol, target) {
  const el = document.getElementById('result');
  if (!sol) {
    el.innerHTML = `<div class="status err">無法找到符合條件的組合（需至少 6 枚 500 元）。</div>`;
    return;
  }
  const diff = sol.sum - target;
  const status = (diff === 0)
    ? `<div class="status ok">✅ 已剛好湊齊 10000 元</div>`
    : `<div class="status warn">⚠️ 無法剛好 10000，最接近的結果（${diff > 0 ? "超過" : "不足"} ${Math.abs(diff)} 元）</div>`;

  const grid = `
    <div class="result-grid">
      ${coinBox("500 元", sol[500])}
      ${coinBox("100 元", sol[100])}
      ${coinBox("50 元",  sol[50])}
      ${coinBox("10 元",  sol[10])}
      ${coinBox("1 元",   sol[1])}
    </div>
  `;
  const summary = `
    <div class="summary">
      <div class="row"><div class="label">合計金額</div><div class="value">${sol.sum.toLocaleString()}</div></div>
      <div class="row"><div class="label">與 10000 的差</div><div class="value">${diff > 0 ? "+" : ""}${diff}</div></div>
    </div>
  `;
  el.innerHTML = status + grid + summary;
}

function scrollToResult() {
  const anchor = document.getElementById('result-end');
  if (anchor) anchor.scrollIntoView({ behavior: 'smooth', block: 'start' });
}

document.getElementById('calcBtn').addEventListener('click', () => {
  const avail = getInputs();
  if (avail[500] < 6) {
    document.getElementById('result').innerHTML = `<div class="status err">500 元可用數量必須至少 6。</div>`;
    scrollToResult();
    return;
  }
  const sol = solveClosest(TARGET, avail);
  renderResult(sol, TARGET);
  requestAnimationFrame(scrollToResult);
});

document.getElementById('resetBtn').addEventListener('click', () => {
  for (const id of ['c500','c100','c50','c10','c1']) document.getElementById(id).value = '';
  document.getElementById('result').innerHTML = '';
  window.scrollTo({ top: 0, behavior: 'smooth' });
});
</script>
</body>
</html>
